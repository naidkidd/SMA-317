{% extends "base.html" %}

{% block content %}
<div class="dashboard">
    <h2>Upload Dokumen Tambahan</h2>

    {% if user.status == 'selesai' %}
    <div class="card">
        <div class="alert alert-error" style="text-align: center; padding: 2rem;">
            <h3 style="color: #F44336; margin-bottom: 1rem;">⚠️ PERINGATAN</h3>
            <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">Pendaftaran Anda sudah diselesaikan. Dokumen tidak dapat diubah lagi.</p>
            <a href="{{ url_for('dashboard_siswa') }}" class="btn-secondary" style="display: inline-block; width: auto; padding: 10px 30px;">
                Kembali ke Dashboard
            </a>
        </div>
    </div>
    {% else %}
    <div class="card">
        <div class="progress-info">
            <h3>Upload Dokumen Pendukung</h3>
            <p>Silakan upload dokumen-dokumen berikut untuk melengkapi pendaftaran Anda. Minimal 3 dokumen harus diupload.</p>
        </div>

        <div class="dokumen-grid">
            <!-- Ijazah -->
            <div class="dokumen-card">
                <h4>Ijazah SMP/MTs</h4>
                {% if dokumen.get('ijazah') %}
                    <p class="status-uploaded">✅ Sudah diupload</p>
                    <p class="file-name">{{ dokumen['ijazah'].filename|truncate(20) }}</p>
                    <p class="status-info">Status: <span class="status-{{ dokumen['ijazah'].status }}">{{ dokumen['ijazah'].status|title }}</span></p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="ijazah">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-secondary">Ganti File</button>
                    </form>
                {% else %}
                    <p class="status-missing">❌ Belum diupload</p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="ijazah">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-primary">Upload Ijazah</button>
                    </form>
                {% endif %}
            </div>

            <!-- Rapor -->
            <div class="dokumen-card">
                <h4>Rapor Semester Terakhir</h4>
                {% if dokumen.get('rapor') %}
                    <p class="status-uploaded">✅ Sudah diupload</p>
                    <p class="file-name">{{ dokumen['rapor'].filename|truncate(20) }}</p>
                    <p class="status-info">Status: <span class="status-{{ dokumen['rapor'].status }}">{{ dokumen['rapor'].status|title }}</span></p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="rapor">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-secondary">Ganti File</button>
                    </form>
                {% else %}
                    <p class="status-missing">❌ Belum diupload</p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="rapor">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-primary">Upload Rapor</button>
                    </form>
                {% endif %}
            </div>

            <!-- Kartu Keluarga -->
            <div class="dokumen-card">
                <h4>Kartu Keluarga (KK)</h4>
                {% if dokumen.get('kk') %}
                    <p class="status-uploaded">✅ Sudah diupload</p>
                    <p class="file-name">{{ dokumen['kk'].filename|truncate(20) }}</p>
                    <p class="status-info">Status: <span class="status-{{ dokumen['kk'].status }}">{{ dokumen['kk'].status|title }}</span></p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="kk">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-secondary">Ganti File</button>
                    </form>
                {% else %}
                    <p class="status-missing">❌ Belum diupload</p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="kk">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-primary">Upload KK</button>
                    </form>
                {% endif %}
            </div>

            <!-- Akta Kelahiran -->
            <div class="dokumen-card">
                <h4>Akta Kelahiran</h4>
                {% if dokumen.get('akta') %}
                    <p class="status-uploaded">✅ Sudah diupload</p>
                    <p class="file-name">{{ dokumen['akta'].filename|truncate(20) }}</p>
                    <p class="status-info">Status: <span class="status-{{ dokumen['akta'].status }}">{{ dokumen['akta'].status|title }}</span></p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="akta">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-secondary">Ganti File</button>
                    </form>
                {% else %}
                    <p class="status-missing">❌ Belum diupload</p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="akta">
                        <input type="file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-primary">Upload Akta</button>
                    </form>
                {% endif %}
            </div>

            <!-- Pas Foto -->
            <div class="dokumen-card">
                <h4>Pas Foto 3x4</h4>
                {% if dokumen.get('foto') %}
                    <p class="status-uploaded">✅ Sudah diupload</p>
                    <p class="file-name">{{ dokumen['foto'].filename|truncate(20) }}</p>
                    <p class="status-info">Status: <span class="status-{{ dokumen['foto'].status }}">{{ dokumen['foto'].status|title }}</span></p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="foto">
                        <input type="file" name="file" accept=".jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-secondary">Ganti File</button>
                    </form>
                {% else %}
                    <p class="status-missing">❌ Belum diupload</p>
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="jenis_dokumen" value="foto">
                        <input type="file" name="file" accept=".jpg,.jpeg,.png" required>
                        <button type="submit" class="btn-primary">Upload Foto</button>
                    </form>
                {% endif %}
            </div>
        </div>

        <div class="form-note">
            <p><strong>Catatan Penting:</strong></p>
            <ul>
                <li>Minimal harus upload <strong>3 dokumen</strong> untuk bisa menyelesaikan pendaftaran</li>
                <li>Format file yang didukung: PDF, JPG, JPEG, PNG</li>
                <li>Ukuran maksimal file: 2MB per dokumen</li>
                <li>Pastikan file terbaca dengan jelas</li>
                <li>Admin akan memverifikasi dokumen yang Anda upload</li>
                <li><strong>Peringatan:</strong> Dokumen tidak dapat diubah setelah menyelesaikan pendaftaran</li>
            </ul>
        </div>

        <div class="form-actions">
            <a href="{{ url_for('dashboard_siswa') }}" class="btn-secondary">Kembali ke Dashboard</a>
        </div>
    </div>
    {% endif %}
</div>

<style>
.dokumen-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
}

.dokumen-card {
    border: 1px solid #E0E0E0;
    padding: 1.5rem;
    border-radius: 8px;
    background: #FFFFFF;
    text-align: center;
    transition: transform 0.3s ease;
}

.dokumen-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.dokumen-card h4 {
    margin-top: 0;
    color: #333333;
    margin-bottom: 1rem;
}

.status-uploaded {
    color: #4CAF50;
    font-weight: bold;
    margin: 0.5rem 0;
}

.status-missing {
    color: #F44336;
    font-weight: bold;
    margin: 0.5rem 0;
}

.file-name {
    color: #666;
    font-size: 0.9rem;
    margin: 0.5rem 0;
}

.status-info {
    margin: 0.5rem 0;
    font-size: 0.9rem;
}

.form-note ul {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.form-note li {
    margin: 0.3rem 0;
    color: #333333;
}

.form-actions {
    display: flex;
    justify-content: center;
    margin-top: 2rem;
}

@media (max-width: 768px) {
    .dokumen-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
